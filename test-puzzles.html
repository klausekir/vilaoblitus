<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Puzzles - Codex Oblitus</title>

    <!-- Definir fun√ß√µes ANTES de tudo -->
    <script>
        // Stubs das fun√ß√µes que ser√£o implementadas depois
        window.testCodePuzzle = function() { alert('Aguarde o sistema carregar...'); };
        window.testPatternPuzzle = function() { alert('Aguarde o sistema carregar...'); };
        window.testSequencePuzzle = function() { alert('Aguarde o sistema carregar...'); };
        window.testPhotographSystem = function() { alert('Aguarde o sistema carregar...'); };
        window.testRotatingDiscs = function() { alert('Aguarde o sistema carregar...'); };
        window.testAllExamples = function() { alert('Aguarde o sistema carregar...'); };
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0a0a;
            color: #f0a500;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 40px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin-bottom: 40px;
            color: #f0a500;
            text-shadow: 0 0 10px rgba(240, 165, 0, 0.5);
        }

        .puzzle-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .test-btn {
            padding: 30px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            border: 2px solid #f0a500;
            border-radius: 15px;
            color: #f0a500;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .test-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(240, 165, 0, 0.3);
            border-color: #ffd700;
        }

        .test-btn .icon {
            font-size: 48px;
            display: block;
            margin-bottom: 10px;
        }

        .test-btn .title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .test-btn .desc {
            font-size: 12px;
            color: #999;
        }

        #game-container {
            width: 100%;
            height: 600px;
            border: 2px solid #f0a500;
            border-radius: 10px;
            margin-top: 20px;
        }

        .info {
            background: #1a1a1a;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .info h2 {
            color: #f0a500;
            margin-bottom: 10px;
        }

        .info p {
            color: #ccc;
            line-height: 1.6;
        }

        .status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #1a1a1a;
            border: 2px solid #4CAF50;
            border-radius: 10px;
            padding: 15px 20px;
            color: #4CAF50;
            font-weight: bold;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Teste de Puzzles - Sistema Blackthorn</h1>

        <div class="info">
            <h2>üìã Instru√ß√µes</h2>
            <p>
                Clique nos bot√µes abaixo para testar cada tipo de puzzle.<br>
                <strong>Importante:</strong> Voc√™ deve estar logado no jogo para os puzzles funcionarem corretamente.
            </p>
        </div>

        <div class="puzzle-buttons">
            <button class="test-btn" onclick="testCodePuzzle()">
                <span class="icon">üî¢</span>
                <div class="title">C√≥digo Num√©rico</div>
                <div class="desc">Solu√ß√£o: 1234</div>
            </button>

            <button class="test-btn" onclick="testPatternPuzzle()">
                <span class="icon">üéØ</span>
                <div class="title">Padr√£o de S√≠mbolos</div>
                <div class="desc">Sequ√™ncia: Corvo ‚Üí Serpente ‚Üí √Åguia ‚Üí Lobo</div>
            </button>

            <button class="test-btn" onclick="testSequencePuzzle()">
                <span class="icon">üéõÔ∏è</span>
                <div class="title">Fechadura com Bot√µes</div>
                <div class="desc">Alinhe as barras no centro</div>
            </button>

            <button class="test-btn" onclick="testPhotographSystem()">
                <span class="icon">üì∑</span>
                <div class="title">Sistema de Fotos</div>
                <div class="desc">Testar c√¢mera e √°lbum</div>
            </button>

            <button class="test-btn" onclick="testRotatingDiscs()">
                <span class="icon">üîÑ</span>
                <div class="title">Discos Rotat√≥rios</div>
                <div class="desc">Alinhar s√≠mbolos (requer Phaser)</div>
            </button>

            <button class="test-btn" onclick="testAllExamples()">
                <span class="icon">‚≠ê</span>
                <div class="title">Exemplos Prontos</div>
                <div class="desc">Testar puzzles do mapa</div>
            </button>
        </div>

        <div id="game-container"></div>
    </div>

    <div class="status">‚úÖ Sistema Carregado</div>

    <!-- Phaser 3 -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>

    <!-- Game Scripts -->
    <script src="js/map.js"></script>
    <script src="js/phaser/managers/GameStateManager.js"></script>
    <script src="js/phaser/managers/UIManager.js"></script>
    <script src="js/phaser/managers/PhotographAlbumUI.js"></script>
    <script src="js/phaser/puzzles/RotatingDiscsPuzzle.js"></script>
    <script src="js/phaser/puzzles/PuzzleManager.js"></script>
    <script src="js/puzzle-examples.js"></script>

    <script>
        // Managers globais j√° s√£o criados pelos pr√≥prios arquivos JS
        // Apenas inicializar o estado
        setTimeout(() => {
            if (typeof gameStateManager !== 'undefined') {
                gameStateManager.init();
            }
        }, 100);

        // Criar scene Phaser simples para testes
        class TestScene extends Phaser.Scene {
            constructor() {
                super({ key: 'TestScene' });
            }

            preload() {
                // Sem assets por enquanto
            }

            create() {
                // Background
                this.add.rectangle(
                    this.scale.width / 2,
                    this.scale.height / 2,
                    this.scale.width,
                    this.scale.height,
                    0x0a0a0a
                );

                // Texto de boas-vindas
                this.add.text(
                    this.scale.width / 2,
                    this.scale.height / 2,
                    'Sistema de Puzzles Carregado!\n\nClique nos bot√µes acima para testar.',
                    {
                        fontSize: '24px',
                        color: '#f0a500',
                        align: 'center'
                    }
                ).setOrigin(0.5);

                // Criar puzzle manager
                window.puzzleManager = new PuzzleManager(this);
            }
        }

        // Configura√ß√£o Phaser
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            parent: 'game-container',
            backgroundColor: '#0a0a0a',
            scene: [TestScene]
        };

        const game = new Phaser.Game(config);

        // FUN√á√ïES DE TESTE (declaradas no escopo global window)

        window.testCodePuzzle = function() {
            console.log('üî¢ Testando Puzzle de C√≥digo...');

            if (!window.puzzleManager) {
                alert('Aguarde o Phaser carregar!');
                return;
            }

            window.puzzleManager.createPuzzle({
                type: 'code',
                id: 'test_code',
                title: 'Teste - C√≥digo Num√©rico',
                description: 'Digite o c√≥digo: 1234',
                digits: 4,
                solution: '1234',
                hints: [
                    { text: 'Dica: O c√≥digo √© 1234!' }
                ],
                onSolved: () => {
                    alert('‚úÖ Puzzle de C√≥digo resolvido com sucesso!');
                }
            });
        };

        window.testPatternPuzzle = function() {
            console.log('üéØ Testando Puzzle de Padr√£o...');

            if (!window.puzzleManager) {
                alert('Aguarde o Phaser carregar!');
                return;
            }

            window.puzzleManager.createPuzzle({
                type: 'pattern',
                id: 'test_pattern',
                title: 'Teste - Padr√£o de S√≠mbolos',
                description: 'Sequ√™ncia: Corvo ‚Üí Serpente ‚Üí √Åguia ‚Üí Lobo',
                symbols: ['corvo', 'lobo', 'serpente', 'aguia'],
                solution: ['corvo', 'serpente', 'aguia', 'lobo'],
                hints: [
                    { text: 'A sequ√™ncia correta √©: Corvo, Serpente, √Åguia, Lobo' }
                ],
                onSolved: () => {
                    alert('‚úÖ Puzzle de Padr√£o resolvido com sucesso!');
                }
            });
        };

        window.testSequencePuzzle = function() {
            console.log('üéõÔ∏è Testando Puzzle de Fechadura...');

            if (!window.puzzleManager) {
                alert('Aguarde o Phaser carregar!');
                return;
            }

            window.puzzleManager.createPuzzle({
                type: 'sequence_buttons',
                id: 'test_sequence',
                title: 'Teste - Fechadura com Bot√µes',
                description: 'Alinhe as barras no centro (50%)',
                elements: [
                    {id: 'barra1', initialPos: 0, targetPos: 50},
                    {id: 'barra2', initialPos: 100, targetPos: 50},
                    {id: 'barra3', initialPos: 25, targetPos: 50}
                ],
                buttons: [
                    {id: 'btn1', moves: ['+25 barra1', '-25 barra2']},
                    {id: 'btn2', moves: ['+25 barra3', '-25 barra1']},
                    {id: 'btn3', moves: ['+25 barra2', '+25 barra3']}
                ],
                targetPos: 50,
                tolerance: 5,
                hints: [
                    { text: 'Experimente: Bot√£o 1 (2x), Bot√£o 3 (1x)' }
                ],
                onSolved: () => {
                    alert('‚úÖ Puzzle de Fechadura resolvido com sucesso!');
                }
            });
        };

        window.testPhotographSystem = function() {
            console.log('üì∑ Testando Sistema de Fotografias...');

            // Tirar algumas fotos de teste
            gameStateManager.takePhotograph(
                'teste_area',
                'objeto1',
                'images/floresta.jpg',
                'Pista na Floresta',
                { clue: 'S√≠mbolo da lua escondido' }
            );

            gameStateManager.takePhotograph(
                'teste_area',
                'objeto2',
                'images/portao_entrada.jpg',
                'Port√£o Antigo',
                { code: '1847' }
            );

            gameStateManager.takePhotograph(
                'teste_area',
                'objeto3',
                'images/floresta.jpg',
                '√Årvore Marcada',
                { pattern: 'Tr√™s c√≠rculos' }
            );

            // Abrir √°lbum
            setTimeout(() => {
                photographAlbumUI.openAlbum();
            }, 500);
        };

        window.testRotatingDiscs = function() {
            console.log('üîÑ Testando Discos Rotat√≥rios...');

            if (!window.puzzleManager) {
                alert('Aguarde o Phaser carregar!');
                return;
            }

            window.puzzleManager.createPuzzle({
                type: 'rotating_discs',
                id: 'test_rotating',
                title: 'Teste - Discos Rotat√≥rios',
                description: 'Alinhe: Lua, √Årvore, √Ågua',
                discs: 3,
                symbols: ['lua', 'sol', 'estrela', 'arvore', 'fogo', 'agua'],
                solution: ['lua', 'arvore', 'agua'],
                hints: [
                    { text: 'Gire os discos at√© alinhar: Lua no disco maior, √Årvore no m√©dio, √Ågua no menor' }
                ],
                onSolved: () => {
                    alert('‚úÖ Puzzle de Discos Rotat√≥rios resolvido com sucesso!');
                }
            });
        };

        window.testAllExamples = function() {
            console.log('‚≠ê Mostrando exemplos dispon√≠veis...');

            const examples = Object.keys(PUZZLE_EXAMPLES);

            const msg = `Exemplos Prontos Dispon√≠veis:\n\n${examples.map((key, i) =>
                `${i + 1}. ${key}\n   Tipo: ${PUZZLE_EXAMPLES[key].type}\n   T√≠tulo: ${PUZZLE_EXAMPLES[key].title}`
            ).join('\n\n')}`;

            alert(msg);

            // Testar o primeiro exemplo
            if (confirm('Deseja testar o primeiro exemplo (Port√£o M√≠stico)?')) {
                window.puzzleManager.createPuzzle(PUZZLE_EXAMPLES.portao_mistico);
            }
        };

        // Log de inicializa√ß√£o
        console.log('%cüéÆ Sistema de Puzzles Carregado!', 'color: #f0a500; font-size: 20px; font-weight: bold;');
        console.log('%cUse os bot√µes na p√°gina ou execute as fun√ß√µes de teste:', 'color: #4CAF50;');
        console.log('- testCodePuzzle()');
        console.log('- testPatternPuzzle()');
        console.log('- testSequencePuzzle()');
        console.log('- testPhotographSystem()');
        console.log('- testRotatingDiscs()');
        console.log('- testAllExamples()');
    </script>
</body>
</html>
